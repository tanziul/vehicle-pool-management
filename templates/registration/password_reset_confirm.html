{% extends "home.html" %}

{% block page_title %}Set New Password{% endblock %}

{% block auth_content %}
<h2>Set New Password</h2>

{% if validlink %}
    <form method="post">
        {% csrf_token %}
        <div class="mb-3">
          
            <div class="password-wrapper">
                <input type="password" name="new_password1" class="egari-input" id="new_password1" required placeholder="Enter new password">
                <button type="button" class="password-toggle" onclick="togglePassword('new_password1', 'toggleIcon1')">
                    <i class="bi bi-eye-slash" id="toggleIcon1"></i>
                </button>
            </div>
            {% if form.new_password1.errors %}
                <small class="text-danger">{{ form.new_password1.errors.0 }}</small>
            {% endif %}
        </div>

        <div class="mb-3">
           
            <div class="password-wrapper">
                <input type="password" name="new_password2" class="egari-input" id="new_password2" required placeholder="Confirm new password">
                <button type="button" class="password-toggle" onclick="togglePassword('new_password2', 'toggleIcon2')">
                    <i class="bi bi-eye-slash" id="toggleIcon2"></i>
                </button>
            </div>
            {% if form.new_password2.errors %}
                <small class="text-danger">{{ form.new_password2.errors.0 }}</small>
            {% endif %}
        </div>

        <button type="submit" class="egari-btn w-100">Change Password</button>
    </form>
{% else %}
    <div class="alert alert-danger text-center">
        The password reset link is invalid or has expired.
    </div>
    <a href="{% url 'password_reset' %}" class="egari-btn w-100 mt-3">Request New Link</a>
{% endif %}

<div class="text-center mt-4">
    <a href="{% url 'login' %}">‚Üê Back to Login</a>
</div>

{% if form.non_field_errors %}
    {% for error in form.non_field_errors %}
        <div class="alert alert-danger mt-3 small">{{ error }}</div>
    {% endfor %}
{% endif %}
{% endblock %}
